<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Live Host - Warcraft Logs</title>
	<link rel="stylesheet" href="/style.css" />
	<style>
		.live-container { width: 1600px; max-width: 100%; margin: 20px auto; padding: 16px; background: rgba(0,0,0,0.5); border-radius: 8px; }
		.controls { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; }
		.controls input[type="text"] { flex: 1; padding: 8px; }
		.time-controls { display: flex; align-items: center; gap: 6px; }
		.time-controls input { width: 48px; padding: 6px 8px; text-align: center; }
		.stream { height: 60vh; overflow-y: auto; overflow-x: auto; background: #0b0b0b; padding: 10px; border-radius: 6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 13px; }
		.line { white-space: pre; color: #ddd; }
		.timestamp { color: #9ad; margin-right: 6px; }
		.status { color: #aaa; font-size: 12px; margin-left: 8px; }
		.encounter-feed { width: 1600px; max-width: 100%; margin: 8px auto 0; padding: 8px 12px; color: #ddd; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
		.encounter-line { margin: 2px 0; }
		.encounter-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 8px; }
		.encounter-box { border: 1px solid #ddd; border-radius: 6px; padding: 8px; background: #fff; }
		.encounter-box-title { font-weight: 600; margin-bottom: 4px; }
		.encounter-box .time { font-size: 12px; color: #333; }
		.live-panels { max-width: 1600px; margin: 10px auto 0; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
		.death-list { display: flex; flex-direction: column; gap: 10px; }
		.meter-list { display: flex; flex-direction: column; gap: 6px; }
		.meter-item { position: relative; border: 1px solid #ddd; border-radius: 6px; overflow: hidden; background: #666666; }
		.meter-bar { position: absolute; top: 0; left: 0; bottom: 0; width: 0%; opacity: 0.85; }
		.meter-row { position: relative; display: flex; justify-content: space-between; padding: 6px 10px; font-size: 14px; z-index: 1; color: #ffffff; }
		.death-card { background: #131313; border: 1px solid #2a2a2a; border-radius: 6px; padding: 10px; color: #ddd; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
		.death-card .title { font-weight: bold; margin-bottom: 6px; display: flex; justify-content: space-between; }
		.death-card .mini-stream { max-height: 180px; overflow-y: auto; overflow-x: auto; background: #0b0b0b; border-radius: 4px; padding: 6px; font-size: 12px; }
	</style>
	<script defer src="/top-bar.js"></script>
	<script defer src="/live.js"></script>
	<link rel="icon" href="/images/1p_logo.png" />
	<meta name="theme-color" content="#000000" />
	<meta name="description" content="Live host controls for Warcraft Logs" />
</head>
<body>
	<div class="top-bar">
		<div class="top-bar-left">
			<img src="/images/1p_logo.png" alt="1Principles" class="app-logo" width="110" height="30">
			<nav class="top-nav">
				<a href="/" class="top-nav-link">Home</a>
				<div class="top-nav-dropdown">
					<button class="top-nav-link dropdown-toggle" id="upcoming-raids-dropdown">Upcoming Raids <i class="fas fa-chevron-down"></i></button>
					<div class="dropdown-menu" id="upcoming-raids-menu"><div class="dropdown-loading">Loading raids...</div></div>
				</div>
				<a href="/guild-members" class="top-nav-link">Guild Members</a>
				<a href="/attendance" class="top-nav-link">Regular Attendance</a>
			</nav>
		</div>
		<div id="auth-container"></div>
	</div>

	<div class="raid-bar" id="raid-bar" style="display: none;">
		<div class="raid-bar-left">
			<span class="raid-title" id="raid-title">Live Host</span>
			<nav class="raid-nav">
				<a href="#" class="raid-nav-link" id="raid-roster-link"><i class="fas fa-users"></i> Roster</a>
				<a href="#" class="raid-nav-link" id="raid-assignments-link"><i class="fas fa-tasks"></i> Assignments</a>
				<a href="/raidlogs" class="raid-nav-link" id="raid-logs-link"><i class="fas fa-chart-line"></i> Raid Logs</a>
				<a href="/gold" class="raid-nav-link" id="raid-goldpot-link"><i class="fas fa-coins"></i> Gold Pot</a>
				<a href="/loot" class="raid-nav-link" id="raid-loot-link"><i class="fas fa-shield-alt"></i> Loot</a>
				<a href="/live" id="live-view-link" class="raid-nav-link" style="display:inline-flex;align-items:center;gap:6px;"><span>Live View</span><span id="live-indicator" style="width:10px;height:10px;border-radius:50%;background:#e74c3c;box-shadow:0 0 6px #e74c3c;"></span></a>
			</nav>
		</div>
		<div class="raid-bar-right">
			<button class="raid-close-btn" onclick="localStorage.removeItem('activeEventSession'); location.reload();"><i class="fas fa-times"></i></button>
		</div>
	</div>

	<div class="live-panels">
		<div class="panel"><h2 class="panel-title">Death Log</h2><div id="death-panel-body" class="death-list"></div></div>
		<div class="panel"><h2 class="panel-title">Encounter Log</h2><div id="encounter-panel-body" class="encounter-grid"></div></div>
		<div class="panel"><h2 class="panel-title">Total Damage (Top 5)</h2><div id="top-dmg-list" class="meter-list"></div></div>
		<div class="panel"><h2 class="panel-title">Total Healing (Top 5)</h2><div id="top-heal-list" class="meter-list"></div></div>
		<div class="panel"><h2 class="panel-title">Encounter Damage (Top 5)</h2><div id="enc-dmg-list" class="meter-list"></div></div>
		<div class="panel"><h2 class="panel-title">Encounter Healing (Top 5)</h2><div id="enc-heal-list" class="meter-list"></div></div>
	</div>

	<div class="live-container">
		<h2>Live Host</h2>
		<div class="controls">
			<input id="reportInput" type="text" placeholder="Enter Warcraft Logs report code or URL" />
			<div class="time-controls" title="Start time (HH MM SS)">
				<input id="hh" type="number" min="0" max="23" value="0" />
				<input id="mm" type="number" min="0" max="59" value="0" />
				<input id="ss" type="number" min="0" max="59" value="0" />
			</div>
			<button id="startSharedBtn" type="button" style="display:none;">Start Shared Live Session</button>
			<button id="stopSharedBtn" type="button" style="display:none;">Stop Shared Live Session</button>
			<span class="status" id="status"></span>
		</div>
		<div id="stream" class="stream" aria-live="polite"></div>
	</div>

	<script>
		// Force host mode: allow management controls; no additional logic needed here
	</script>
</body>
</html>


